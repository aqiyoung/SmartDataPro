# 统一文档转换工具 - 功能介绍

## 1. 项目概述

统一文档转换工具是一个基于 Web 的文档格式转换平台，支持多种文档格式之间的相互转换，提供简单易用的界面和稳定可靠的转换服务。

### 1.1 核心价值
- 🔄 **多格式支持**：支持多种常见文档格式的转换
- 🎨 **友好界面**：直观易用的 Web 界面，无需安装任何软件
- ⚡ **快速转换**：高效的转换算法，快速生成转换结果
- 💾 **安全可靠**：本地转换，数据隐私有保障
- 🌐 **跨平台**：支持 Windows、macOS、Linux 等多种操作系统

### 1.2 技术栈
- **前端**：React 18 + Vite + Axios
- **后端**：FastAPI + Python 3.11+ + Uvicorn
- **转换核心**：python-docx、mammoth、markdown、pdfplumber、pypdf、BeautifulSoup

## 2. 支持的转换类型

### 2.1 网页转 Word 文档
- **功能**：将指定 URL 的网页内容转换为 Word 文档
- **特点**：
  - 自动提取网页标题作为文件名
  - 保留网页原有排版格式
  - 支持图片自动下载和插入
  - 支持 URL 有效性验证
  - 生成符合标准的 DOCX 格式

### 2.2 Word 转 Markdown
- **功能**：将 Word 文档转换为 Markdown 格式
- **支持格式**：DOC、DOCX
- **特点**：
  - 保留文档结构和格式
  - 支持表格、列表转换
  - 支持图片提取和引用
  - 生成标准 Markdown 语法

### 2.3 Markdown 转 HTML
- **功能**：将 Markdown 文本转换为美观的 HTML 页面
- **特点**：
  - 支持多种样式主题
  - 实时预览转换效果
  - 支持代码高亮
  - 支持数学公式渲染
  - 生成响应式设计

### 2.4 PDF 转 Word
- **功能**：将 PDF 文件转换为可编辑的 Word 文档
- **特点**：
  - 保留原始布局和格式    
  - 支持文字和图片提取
  - 支持多页 PDF 转换
  - 生成 DOCX 格式文档

### 2.5 Word 转 PDF
- **功能**：将 Word 文档转换为 PDF 格式
- **支持格式**：DOC、DOCX
- **特点**：
  - 保留文档原有样式
  - 支持批量转换
  - 生成高质量 PDF

## 3. 系统架构

### 3.1 整体架构
```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   前端应用     │────▶│   API 服务      │────▶│  转换引擎       │
│  (React + Vite)│     │  (FastAPI)      │     │  (Python 库)    │
└─────────────────┘     └─────────────────┘     └─────────────────┘
          ▲                       ▲                       ▲
          │                       │                       │
          ▼                       ▼                       ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   用户浏览器    │     │  HTTP 协议      │     │  临时文件存储   │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

### 3.2 前端架构
- **单页应用**：基于 React 18 构建的 SPA
- **组件化设计**：模块化的组件结构，易于维护和扩展
- **响应式布局**：适配不同屏幕尺寸
- **实时通信**：使用 Axios 与后端 API 通信

### 3.3 后端架构
- **RESTful API**：遵循 REST 设计规范
- **异步处理**：使用 Python asyncio 实现异步处理
- **多线程转换**：支持并发转换请求
- **错误处理**：完善的错误捕获和处理机制

## 4. 使用方法

### 4.1 启动服务

#### 4.1.1 后端服务
```bash
# 进入后端目录
cd backend

# 安装依赖
python -m pip install -r requirements.txt

# 启动服务
python main.py
```

#### 4.1.2 前端服务
```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 4.2 访问应用

1. 启动后端服务后，访问：http://localhost:8005
2. 启动前端服务后，访问：http://localhost:5180
3. 在浏览器中打开前端地址，即可使用转换功能

### 4.3 使用步骤

#### 4.3.1 网页转 Word
1. 选择「网页转 Word」转换类型
2. 在输入框中粘贴要转换的网页 URL
3. 点击「开始转换」按钮
4. 等待转换完成，自动下载生成的 Word 文档

#### 4.3.2 文件转换（Word、Markdown、PDF）
1. 选择对应的转换类型
2. 点击「选择文件」按钮，上传要转换的文件
3. 根据需要设置转换选项（如样式主题等）
4. 点击「开始转换」按钮
5. 等待转换完成，自动下载转换结果

## 5. 各功能模块详细说明

### 5.1 网页转 Word 模块

#### 5.1.1 核心功能
- **URL 验证**：验证输入 URL 的有效性和可达性
- **标题提取**：从网页中提取标题作为文件名
- **内容解析**：使用 BeautifulSoup 解析 HTML 内容
- **图片处理**：自动下载网页中的图片并插入到 Word 文档
- **样式保留**：尽量保留网页的原始样式和布局

#### 5.1.2 转换流程
1. 验证输入 URL
2. 发送 HTTP 请求获取网页内容
3. 提取网页标题和正文
4. 处理和下载网页中的图片
5. 创建 Word 文档并添加内容
6. 保存文档并返回给用户

#### 5.1.3 技术细节
- 使用 `requests` 库发送 HTTP 请求
- 使用 `BeautifulSoup` 解析 HTML
- 使用 `python-docx` 创建和编辑 Word 文档
- 使用多线程处理图片下载，提高转换效率

### 5.2 Word 转 Markdown 模块

#### 5.2.1 核心功能
- **文档解析**：解析 Word 文档的结构和内容
- **格式转换**：将 Word 格式转换为 Markdown 格式
- **图片提取**：提取 Word 中的图片并保存
- **表格处理**：将 Word 表格转换为 Markdown 表格
- **列表转换**：将 Word 列表转换为 Markdown 列表

#### 5.2.2 技术细节
- 使用 `mammoth` 库将 Word 转换为 HTML
- 再将 HTML 转换为 Markdown
- 支持自定义转换规则

### 5.3 Markdown 转 HTML 模块

#### 5.3.1 核心功能
- **Markdown 解析**：将 Markdown 文本解析为 AST
- **HTML 生成**：将 AST 转换为 HTML 代码
- **样式应用**：支持多种样式主题
- **实时预览**：提供转换结果的实时预览

#### 5.3.2 支持的样式主题
- **default**：默认样式
- **github**：GitHub 风格
- **vuepress**：VuePress 风格
- **mkdocs**：MkDocs 风格

### 5.4 PDF 转 Word 模块

#### 5.4.1 核心功能
- **PDF 解析**：解析 PDF 文件的内容和布局
- **文字提取**：提取 PDF 中的文字内容
- **图片提取**：提取 PDF 中的图片
- **格式还原**：尽量还原原始文档的格式和布局

#### 5.4.2 技术细节
- 使用 `pdfplumber` 库提取 PDF 内容
- 使用 `pypdf` 处理 PDF 文件
- 支持多页 PDF 转换

### 5.5 Word 转 PDF 模块

#### 5.5.1 核心功能
- **Word 解析**：读取 Word 文档内容
- **PDF 生成**：将 Word 内容转换为 PDF 格式
- **样式保留**：保留原始 Word 文档的样式和布局

#### 5.5.2 技术细节
- 使用 `python-docx` 读取 Word 文档
- 使用 `reportlab` 库生成 PDF

## 6. 配置选项

### 6.1 后端配置

#### 6.1.1 端口配置
- 默认端口：8005
- 可在 `main.py` 中修改端口号

#### 6.1.2 超时配置
- 网页请求超时：10 秒
- 转换超时：20 秒
- 可在 `app.py` 中调整超时设置

### 6.2 前端配置

#### 6.2.1 API 地址
- 默认 API 地址：http://localhost:8005
- 可在前端代码中修改 API 基础 URL

#### 6.2.2 转换选项
- 支持设置转换样式、超时时间等选项
- 可在前端界面中根据需要调整

## 7. 常见问题与解决方案

### 7.1 转换失败
- **问题**：上传文件后转换失败
- **解决方案**：
  1. 检查文件格式是否支持
  2. 检查文件大小是否超过限制
  3. 检查网络连接是否正常
  4. 查看服务器日志获取详细错误信息

### 7.2 图片不显示
- **问题**：转换后的文档中图片不显示
- **解决方案**：
  1. 检查原始文档中的图片是否完整
  2. 检查网络连接是否正常（网页转 Word 时）
  3. 检查服务器临时目录权限

### 7.3 样式丢失
- **问题**：转换后的文档样式与原始文档不一致
- **解决方案**：
  1. 不同格式之间的样式支持存在差异
  2. 尝试调整转换选项
  3. 手动调整转换后的文档样式

## 8. 系统要求

### 8.1 服务器要求
- **操作系统**：Windows、macOS、Linux
- **Python 版本**：3.11 及以上
- **内存**：至少 4GB
- **磁盘空间**：至少 1GB 可用空间

### 8.2 客户端要求
- **浏览器**：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
- **网络连接**：稳定的互联网连接
- **分辨率**：建议 1920x1080 及以上

## 9. 扩展性设计

### 9.1 新增转换类型
1. 在后端 `src/converters/` 目录下创建新的转换模块
2. 实现转换逻辑和相关接口
3. 在前端添加对应的转换选项和界面
4. 更新 API 文档和使用说明

### 9.2 优化转换算法
1. 分析现有转换算法的性能瓶颈
2. 优化关键代码路径
3. 引入并行处理或异步处理
4. 测试优化效果，确保转换质量

## 10. 安全与隐私

### 10.1 数据处理
- 转换过程在本地服务器进行，数据不经过第三方服务器
- 转换完成后自动清理临时文件
- 支持设置临时文件过期时间

### 10.2 访问控制
- 可配置 IP 白名单，限制访问来源
- 支持添加 API 密钥认证
- 提供请求频率限制，防止恶意请求

## 11. 监控与日志

### 11.1 日志记录
- 详细记录转换请求和处理过程
- 记录错误信息和异常堆栈
- 支持不同日志级别（DEBUG、INFO、WARNING、ERROR）

### 11.2 性能监控
- 记录转换时间和资源占用
- 提供转换成功率统计
- 支持生成性能报告

## 12. 总结

统一文档转换工具是一个功能全面、易于使用的文档转换平台，支持多种常见文档格式之间的相互转换。通过友好的 Web 界面，用户可以轻松完成各种文档格式转换任务，无需安装任何软件。

该工具采用现代化的技术栈构建，具有良好的扩展性和可维护性，可以根据需求不断添加新的转换类型和功能。同时，该工具注重数据安全和隐私保护，确保用户数据的安全性。

无论是个人用户还是企业用户，都可以通过统一文档转换工具提高文档处理效率，降低格式转换的复杂度，实现文档的高效管理和利用。

## 13. 更新日志

### v1.3.1（2026-01-15）
- 优化 OCR 引擎：增加图像预处理，提升识别率
- 修复 Word 转 PDF 功能的 Bug
- 优化依赖管理，支持更多运行环境

### v1.3.0（2026-01-13）
- 修复网页转 Word 文件名问题
- 优化图片提取和插入逻辑
- 增强 URL 验证和错误处理
- 改进 Content-Disposition 头处理
- 添加详细的日志记录

### v1.2.0（2026-01-12）
- 新增 Word 转 PDF 功能
- 新增 PDF 转 Word 功能
- 优化前端界面设计
- 改进转换性能

### v1.1.0（2026-01-11）
- 新增 Markdown 转 HTML 功能
- 支持多种样式主题
- 提供实时预览功能

### v1.0.0（2026-01-10）
- 初始版本
- 支持网页转 Word 功能
- 支持 Word 转 Markdown 功能
- 基本的前端界面

## 14. 联系方式

- **项目地址**：https://github.com/aqiyoung/unified-tools-web
- **问题反馈**：https://github.com/aqiyoung/unified-tools-web/issues
- **技术支持**：可通过 GitHub Issues 提交问题

---

**文档版本**：v1.3.1  
**更新日期**：2026-01-15  
**作者**：统一文档转换工具开发团队